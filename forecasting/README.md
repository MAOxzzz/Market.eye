# Stock Forecasting Component üìà

This directory contains the components needed for the stock forecasting portion of the Market Eye AI project.

## üöÄ Component Overview

1. **LSTM Stock Price Forecasting**

   - Implements deep learning LSTM (Long Short-Term Memory) networks to predict future stock prices
   - Handles training, evaluation, and forecasting for multiple ticker symbols
   - Supports customizable forecast horizons (days to predict in the future)

2. **Data Update Pipeline**

   - Simulates daily stock data updates through 2024
   - Provides functionality to backfill missing data
   - Enables scheduled updates to keep data current

3. **Forecasting API**
   - Integrates with the main Streamlit application
   - Provides easy-to-use functions for generating forecasts
   - Creates visualizations and exports data to CSV or PDF reports

## üìã File Structure

- `stock_forecaster.py`: Core LSTM model implementation for stock price forecasting
- `data_updater.py`: Functions to update and extend the stock dataset
- `forecast_api.py`: API interface for the Streamlit app to access forecasting features
- `expand_dataset.py`: Utility to expand datasets when not enough data is available
- `models/`: Directory where trained models and scalers are stored
- `test_forecasting.py`: Test script to verify forecasting components

## üõ†Ô∏è How to Use the Forecasting System

### Data Sources

The forecasting components work with several data sources:

1. **Original dataset**: The default Dataset.csv in data/stock_data directory
2. **Enhanced dataset**: The enhanced_dataset.csv in data/stock_data with more historical data
3. **Expanded dataset**: Synthetic data generated by expand_dataset.py (saved to data/stock_data/expanded_dataset.csv)
4. **User uploaded dataset**: Data uploaded by users through the Streamlit interface (saved to data/stock_data/uploaded_dataset.csv)
5. **Updated dataset**: Dataset with simulated future prices (saved to data/stock_data/updated_dataset.csv)

The components automatically use the best available dataset in order of preference.

### Training Models

Models must be trained before forecasts can be generated. You can train models in two ways:

1. **From the Streamlit UI:**

   - Go to the "Stock Forecast" tab
   - Select your preferred dataset
   - Click the "Train Forecasting Models" button

2. **From the Command Line:**
   ```
   python -m forecasting.stock_forecaster
   ```

### Updating Stock Data

The system can update stock data to simulate having the latest prices:

1. **From the Streamlit UI:**

   - Go to the "Stock Forecast" tab
   - Click the "Update Stock Data" button

2. **From the Command Line:**
   ```
   python -m forecasting.data_updater
   ```

### Generating Forecasts

After models are trained, you can generate forecasts:

1. **From the Streamlit UI:**

   - Go to the "Stock Forecast" tab
   - Select a ticker, forecast horizon, and historical days to display
   - Click "Generate Forecast"

2. **Programmatically:**

   ```python
   from forecasting.forecast_api import ForecastAPI

   # Initialize API
   forecast_api = ForecastAPI()

   # Get forecast for a ticker
   forecast_df = forecast_api.get_forecast('AAPL', days=30)

   # Plot forecast
   fig = forecast_api.plot_forecast('AAPL')
   ```

## üìä Evaluation Metrics

The forecasting system uses several metrics to evaluate performance:

- **RMSE (Root Mean Squared Error)**: Measures the average magnitude of prediction errors
- **MSE (Mean Squared Error)**: Similar to RMSE but without the square root
- **R¬≤**: Indicates how well the model explains the variance in the data
- **Custom Accuracy**: Percentage of predictions within 5% of true values

## üîÑ Integration with Main App

The forecasting component is integrated into the main Streamlit app with:

1. A dedicated "Stock Forecast" tab for generating and viewing forecasts
2. Enhanced PDF reports that include both AI recommendations and price forecasts
3. Data export capabilities for further analysis

## üîß Customization

You can customize several aspects of the forecasting system:

- **Model Architecture**: Modify the LSTM layers in `stock_forecaster.py`
- **Forecast Horizon**: Change the number of days to forecast
- **Evaluation Metrics**: Add custom metrics in the `evaluate_model` function
- **Backfill Range**: Adjust the date range in `data_updater.py`

## üìà Future Improvements

Potential enhancements for the forecasting system:

- Implement additional model architectures (GRU, Transformer)
- Add feature engineering for better predictions
- Support for more ticker symbols
- Real-time data integration with financial APIs

# Market Eye AI - Forecasting Module

This module provides forecasting capabilities for stock prices and automated data updates.

## Features

- Linear regression model for stock price forecasting
- Automated daily updates of stock data
- Data backfilling capabilities up to December 2024
- Scheduled pipeline for keeping data current

## Data Updater

The `data_updater.py` script provides several functions to keep your stock data current:

### Command Line Usage

```
usage: data_updater.py [-h] [--schedule] [--backfill] [--update]
                       [--end-date END_DATE] [--update-time UPDATE_TIME]
                       [--input INPUT] [--output OUTPUT]

Stock Market Dataset Updater

optional arguments:
  -h, --help                Show this help message and exit
  --schedule                Set up daily scheduled updates
  --backfill                Backfill the dataset to a specific date
  --update                  Update the dataset with one day of data
  --end-date END_DATE       End date for backfilling (YYYY-MM-DD)
  --update-time UPDATE_TIME Time to run daily updates (HH:MM)
  --input INPUT             Input dataset path
  --output OUTPUT           Output dataset path
```

### Examples

#### One-time update

```
python forecasting/data_updater.py --update
```

#### Backfill data to December 31, 2024

```
python forecasting/data_updater.py --backfill --end-date 2024-12-31
```

#### Set up daily scheduled updates that run until December 31, 2024

```
python forecasting/data_updater.py --schedule --update-time 00:00 --end-date 2024-12-31
```

### Windows Task Scheduler Setup

For Windows users, you can set up automated tasks using the provided batch script:

```
forecasting/setup_scheduled_update.bat
```

This script will create two scheduled tasks:

1. **MarketEyeAI_Stock_Update**: Runs daily at midnight to update stock data
2. **MarketEyeAI_Stock_Backfill**: Runs monthly to ensure backfilling until December 31, 2024

## Dataset Integration

The system automatically integrates with the Kaggle "World Stock Prices ‚Äì Daily Updating" dataset. It maintains the dataset through December 31, 2024 with the following process:

1. Initial data is loaded from one of these locations (in order of precedence):

   - data/stock_data/enhanced_dataset.csv
   - data/stock_data/uploaded_dataset.csv
   - data/stock_data/Dataset.csv

2. The system adds simulated stock prices when needed, maintaining the statistical properties of the original data.

3. Daily updates are automatically scheduled and run until December 31, 2024.

## Forecast API

The `forecast_api.py` provides simplified access to the forecasting capabilities:

```python
from forecasting.forecast_api import ForecastAPI

# Initialize API
api = ForecastAPI()

# Get available tickers
tickers = api.get_available_tickers()

# Get forecast for Apple stock (30 days)
forecast = api.get_forecast('AAPL', days=30)

# Plot forecast
fig = api.plot_forecast('AAPL')
```
